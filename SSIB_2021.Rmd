---
title: "AuracleAnalyses_SSIB_2021"
output:
  word_document: default
  pdf_document: default
  html_document: default
editor_options:
  chunk_output_type: console
---


## Data organiztion
```{r load data, include=FALSE}

### NOTE: These files were generated by Gen_files_for_EventInInt.R
# these csv files contain BITES ONLY (eat_f) events

# set directory
basedir <- ("~/OneDrive - The Pennsylvania State University/Bari-files-Manual-Box-Transfer/00_PennState/Bout_Project")
setwd(file.path(basedir,"Data/Split/BitesOnly/"))

# Load files
meal_file_names = list.files(pattern="*meal*", full.names = TRUE)
meal_files = lapply(meal_file_names, read.csv, header = TRUE)

snack_file_names = list.files(pattern="*snack*", full.names = TRUE)
snack_files = lapply(snack_file_names, read.csv, header = TRUE)

```

```{r Source Event_in_integer function and run , include=FALSE}
setwd(file.path(basedir,"Scripts/"))
source("Event_in_interval.R")


# Event_in_interval.R contains a function that will divide meals/snacks into increments and compute cumualtive number of bites and average IEI within each interval
### Apply Function ###

# Set desired intervals
intlist <- list(10)
unit = "percentage"

## FOR MEALS
for (interval in intlist) { 
    # Make temporary empty dataframe that all data will be added to
    temp <- data.frame(matrix(ncol = 7, nrow = 0))
      for (file in meal_files) {
        if (nrow(file) == 0) {
          print("no data")
        }
        else if (nrow(file) > 1) {
          sesnum <- (file$session[1])
          parid <- print(file$parid[1], max.levels = 0)
          output <- event_in_interval(file, unit, interval, IEI = TRUE)
          output$ParID <- parid
          output$session <- sesnum
          output$ID <- as.character(paste(output$ParID, output$session, sep = "_"))
          
          # Add participant's data to compiled dataframe
          temp <- rbind(temp, output)
        }
      }
    # Modify name of temporary dataframe
    assign(paste0("Meal_Event_in_", unit, "_interval_", interval), temp)
    rm(temp)
}

### FOR SNACKS
for (interval in intlist) { 
    # Make temporary empty dataframe that all data will be added to
    temp <- data.frame(matrix(ncol = 7, nrow = 0))
      for (file in snack_files) {
        if (nrow(file) == 0) {
          print("no data")
        }
        
        else if (nrow(file) > 1) {
          sesnum <- (file$session[1])
          parid <- print(file$parid[1], max.levels = 0)
          output <- event_in_interval(file, unit, interval, IEI = TRUE)
          output$ParID <- parid
          output$session <- sesnum
          output$ID <- as.character(paste(output$ParID, output$session, sep = "_"))

          # Add participant's data to compiled dataframe
          temp <- rbind(temp, output)
        }
      }
    # Modify name of temporary dataframe
    assign(paste0("Snack_Event_in_", unit, "_interval_", interval), temp)
    rm(temp)
}


```

## RMSE for Cumulative Bite Curve
Meal/Snack_Event_in_percentage_interval_10 was generated by Event_in_interval.R script (sourced above)

```{r cumulative bite curve between and within person RMSE - MEALS, include=FALSE}
library(reshape2)

ID = unique(Meal_Event_in_percentage_interval_10$ParID)
RMSE_int10_meal = data.frame(matrix(rep(NA,8*length(ID)),ncol = 8))
names(RMSE_int10_meal) = c("ParID", "nsess","within_RMSE","between_RMSE","within_RMSE_scaled",
                      "between_RMSE_scaled","within_RMSE_prop","between_RMSE_prop")

for (i in 1:length(ID)) {
  dat = Meal_Event_in_percentage_interval_10[Meal_Event_in_percentage_interval_10$ParID == ID[i],]
  nsess = length(unique(dat$session))
  RMSE_int10_meal[i,"ParID"] = as.character(ID[i])
  RMSE_int10_meal[i,"nsess"] = nsess
  
  if (nsess > 1) {
    btw_RMSE_vector = NA
    btw_RMSE_vector_scaled = NA
    btw_RMSE_vector_prop = NA
    
    Bite_cum_1 = dat[dat$session == 1, "EventCount_cumulative"]
    Bite_cum_2 = dat[dat$session == 2, "EventCount_cumulative"]
    within_rmse_1.2 = sqrt(mean((Bite_cum_1 - Bite_cum_2)^2))
    within_rmse_1.2_prop = sqrt(mean(((Bite_cum_1/Bite_cum_1[10]) - (Bite_cum_2/Bite_cum_2[10]))^2))
    
    if (nsess == 2) {
      avg_within_RMSE = within_rmse_1.2
      avg_within_RMSE_scaled = within_rmse_1.2/abs(Bite_cum_1[10] - Bite_cum_2[10])
      avg_within_RMSE_prop = within_rmse_1.2_prop
      
      
    } else if (nsess == 3) {
      Bite_cum_3 = dat[dat$session == 3, "EventCount_cumulative"]
      within_rmse_1.3 = sqrt(mean((Bite_cum_1 - Bite_cum_3)^2))
      within_rmse_2.3 = sqrt(mean((Bite_cum_2 - Bite_cum_3)^2))
      
      within_rmse_1.3_prop = sqrt(mean(((Bite_cum_1/Bite_cum_1[10]) - (Bite_cum_3/Bite_cum_3[10]))^2))
      within_rmse_2.3_prop = sqrt(mean(((Bite_cum_2/Bite_cum_2[10]) - (Bite_cum_3/Bite_cum_3[10]))^2))
      
      
      avg_within_RMSE = mean(within_rmse_1.2, within_rmse_1.3, within_rmse_2.3)
      avg_within_RMSE_prop = mean(within_rmse_1.2_prop, within_rmse_1.3_prop, within_rmse_2.3_prop)
      avg_within_RMSE_scaled = mean(within_rmse_1.2/abs(Bite_cum_1[10] - Bite_cum_2[10]), 
                                    within_rmse_1.3/abs(Bite_cum_1[10] - Bite_cum_3[10]), 
                                    within_rmse_2.3/abs(Bite_cum_2[10] - Bite_cum_3[10]))
      
      
    }
    RMSE_int10_meal[i,"within_RMSE"] = avg_within_RMSE
    RMSE_int10_meal[i,"within_RMSE_scaled"] = avg_within_RMSE_scaled
    RMSE_int10_meal[i,"within_RMSE_prop"] = avg_within_RMSE_prop
    
    dat_other = Meal_Event_in_percentage_interval_10[Meal_Event_in_percentage_interval_10$ParID != ID[i],]
    dat_other_wide = dcast(dat_other, IntNum ~ ParID + session, value.var = "EventCount_cumulative")
    n_other = ncol(dat_other_wide)
    
    for (s in 1:nsess) {
      # By session average RMSE
      #btw_RMSE_vector = NA
      for (c in 2:n_other) {
        Bite_cum = dat[dat$session == s, "EventCount_cumulative"]
        Bite_cum_other = dat_other_wide[,c]
        btw_RMSE = sqrt(mean((Bite_cum - Bite_cum_other)^2))
        btw_RMSE_scaled = btw_RMSE/abs(Bite_cum[10] - Bite_cum_other[10])
        btw_RMSE_prop = sqrt(mean(((Bite_cum/Bite_cum[10]) - (Bite_cum_other/Bite_cum_other[10]))^2))
        
        #add to vector
        btw_RMSE_vector[c-1] = btw_RMSE
        btw_RMSE_vector_scaled[c-1] = btw_RMSE_scaled
        btw_RMSE_vector_prop[c-1] = btw_RMSE_prop
      }
      #RMSE_int10[i,"between_RMSE_sess"] = mean(btw_RMSE_vector)
    }
    RMSE_int10_meal[i,"between_RMSE"] = mean(btw_RMSE_vector)
    RMSE_int10_meal[i,"between_RMSE_scaled"] = mean(btw_RMSE_vector_scaled)
    RMSE_int10_meal[i,"between_RMSE_prop"] = mean(btw_RMSE_vector_prop)
  }
  
}

n_meal_bite <- length(RMSE_int10_meal$within_RMSE[!is.na(RMSE_int10_meal$within_RMSE)])
n_meal_bite_less_error_within <- sum(RMSE_int10_meal$between_RMSE>RMSE_int10_meal$within_RMSE, na.rm = TRUE)

meal_mean_bite_within <- mean(RMSE_int10_meal$within_RMSE, na.rm = TRUE)
meal_SD_bite_within <- sd(RMSE_int10_meal$within_RMSE, na.rm = TRUE)
meal_mean_bite_btw <- mean(RMSE_int10_meal$between_RMSE, na.rm = TRUE)
meal_SD_bite_btw <- sd(RMSE_int10_meal$between_RMSE, na.rm = TRUE)
```

```{r cumulative bite curve between and within person RMSE - SNACKS, include=FALSE}
library(reshape2)

# remove subject 0043
Snack_Event_in_percentage_interval_10_no0043 <- Snack_Event_in_percentage_interval_10[!(Snack_Event_in_percentage_interval_10$ParID == "AUR0043"),]

ID = unique(Snack_Event_in_percentage_interval_10_no0043$ParID)
RMSE_int10_snack = data.frame(matrix(rep(NA,8*length(ID)),ncol = 8))
names(RMSE_int10_snack) = c("ParID", "nsess","within_RMSE","between_RMSE","within_RMSE_scaled",
                      "between_RMSE_scaled","within_RMSE_prop","between_RMSE_prop")

for (i in 1:length(ID)) {
  dat = Snack_Event_in_percentage_interval_10_no0043[Snack_Event_in_percentage_interval_10_no0043$ParID == ID[i],]
  nsess = length(unique(dat$session))
  RMSE_int10_snack[i,"ParID"] = as.character(ID[i])
  RMSE_int10_snack[i,"nsess"] = nsess
  
  if (nsess > 1) {
    btw_RMSE_vector = NA
    btw_RMSE_vector_scaled = NA
    btw_RMSE_vector_prop = NA
    
    Bite_cum_1 = dat[dat$session == 1, "EventCount_cumulative"]
    Bite_cum_2 = dat[dat$session == 2, "EventCount_cumulative"]
    within_rmse_1.2 = sqrt(mean((Bite_cum_1 - Bite_cum_2)^2))
    within_rmse_1.2_prop = sqrt(mean(((Bite_cum_1/Bite_cum_1[10]) - (Bite_cum_2/Bite_cum_2[10]))^2))
    
    if (nsess == 2) {
      avg_within_RMSE = within_rmse_1.2
      avg_within_RMSE_scaled = within_rmse_1.2/abs(Bite_cum_1[10] - Bite_cum_2[10])
      avg_within_RMSE_prop = within_rmse_1.2_prop
      
      
    } else if (nsess == 3) {
      Bite_cum_3 = dat[dat$session == 3, "EventCount_cumulative"]
      within_rmse_1.3 = sqrt(mean((Bite_cum_1 - Bite_cum_3)^2))
      within_rmse_2.3 = sqrt(mean((Bite_cum_2 - Bite_cum_3)^2))
      
      within_rmse_1.3_prop = sqrt(mean(((Bite_cum_1/Bite_cum_1[10]) - (Bite_cum_3/Bite_cum_3[10]))^2))
      within_rmse_2.3_prop = sqrt(mean(((Bite_cum_2/Bite_cum_2[10]) - (Bite_cum_3/Bite_cum_3[10]))^2))
      
      
      avg_within_RMSE = mean(within_rmse_1.2, within_rmse_1.3, within_rmse_2.3)
      avg_within_RMSE_prop = mean(within_rmse_1.2_prop, within_rmse_1.3_prop, within_rmse_2.3_prop)
      avg_within_RMSE_scaled = mean(within_rmse_1.2/abs(Bite_cum_1[10] - Bite_cum_2[10]), 
                                    within_rmse_1.3/abs(Bite_cum_1[10] - Bite_cum_3[10]), 
                                    within_rmse_2.3/abs(Bite_cum_2[10] - Bite_cum_3[10]))
      
      
    }
    RMSE_int10_snack[i,"within_RMSE"] = avg_within_RMSE
    RMSE_int10_snack[i,"within_RMSE_scaled"] = avg_within_RMSE_scaled
    RMSE_int10_snack[i,"within_RMSE_prop"] = avg_within_RMSE_prop
    
    dat_other = Snack_Event_in_percentage_interval_10_no0043[Snack_Event_in_percentage_interval_10_no0043$ParID != ID[i],]
    dat_other_wide = dcast(dat_other, IntNum ~ ParID + session, value.var = "EventCount_cumulative")
    n_other = ncol(dat_other_wide)
    
    for (s in 1:nsess) {
      # By session average RMSE
      #btw_RMSE_vector = NA
      for (c in 2:n_other) {
        Bite_cum = dat[dat$session == s, "EventCount_cumulative"]
        Bite_cum_other = dat_other_wide[,c]
        btw_RMSE = sqrt(mean((Bite_cum - Bite_cum_other)^2))
        btw_RMSE_scaled = btw_RMSE/abs(Bite_cum[10] - Bite_cum_other[10])
        btw_RMSE_prop = sqrt(mean(((Bite_cum/Bite_cum[10]) - (Bite_cum_other/Bite_cum_other[10]))^2))
        
        #add to vector
        btw_RMSE_vector[c-1] = btw_RMSE
        btw_RMSE_vector_scaled[c-1] = btw_RMSE_scaled
        btw_RMSE_vector_prop[c-1] = btw_RMSE_prop
      }
      #RMSE_int10[i,"between_RMSE_sess"] = mean(btw_RMSE_vector)
    }
    RMSE_int10_snack[i,"between_RMSE"] = mean(btw_RMSE_vector)
    RMSE_int10_snack[i,"between_RMSE_scaled"] = mean(btw_RMSE_vector_scaled)
    RMSE_int10_snack[i,"between_RMSE_prop"] = mean(btw_RMSE_vector_prop)
  }
  
}

n_snack_bite <- length(RMSE_int10_snack$within_RMSE[!is.na(RMSE_int10_snack$within_RMSE)])
n_snack_bite_less_error_within <- sum(RMSE_int10_snack$between_RMSE>RMSE_int10_snack$within_RMSE, na.rm = TRUE)


snack_mean_bite_within <- mean(RMSE_int10_snack$within_RMSE, na.rm = TRUE)
snack_SD_bite_within <- sd(RMSE_int10_snack$within_RMSE, na.rm = TRUE)
snack_mean_bite_btw <- mean(RMSE_int10_snack$between_RMSE, na.rm = TRUE)
snack_SD_bite_btw <- sd(RMSE_int10_snack$between_RMSE, na.rm = TRUE)

```

## RMSE for IEI intervals

```{r IEI intervals between and within person RMSE - MEALS, include=FALSE}
library(reshape2)

ID = unique(Meal_Event_in_percentage_interval_10$ParID)
RMSE_int10_meal_IEI = data.frame(matrix(rep(NA,8*length(ID)),ncol = 8))
names(RMSE_int10_meal_IEI) = c("ParID", "nsess","within_RMSE","between_RMSE","within_RMSE_scaled",
                      "between_RMSE_scaled","within_RMSE_prop","between_RMSE_prop")

for (i in 1:length(ID)) {
  dat = Meal_Event_in_percentage_interval_10[Meal_Event_in_percentage_interval_10$ParID == ID[i],]
  nsess = length(unique(dat$session))
  RMSE_int10_meal_IEI[i,"ParID"] = as.character(ID[i])
  RMSE_int10_meal_IEI[i,"nsess"] = nsess
  
  if (nsess > 1) {
    btw_RMSE_vector = NA
    btw_RMSE_vector_scaled = NA
    btw_RMSE_vector_prop = NA
    
    IEI_avg_1 = dat[dat$session == 1, "IEI_avg"]
    IEI_avg_2 = dat[dat$session == 2, "IEI_avg"]
    within_rmse_1.2 = sqrt(mean((IEI_avg_1 - IEI_avg_2)^2))
    within_rmse_1.2_prop = sqrt(mean(((IEI_avg_1/IEI_avg_1[10]) - (IEI_avg_2/IEI_avg_2[10]))^2))
    
    if (nsess == 2) {
      avg_within_RMSE = within_rmse_1.2
      avg_within_RMSE_scaled = within_rmse_1.2/abs(IEI_avg_1[10] - IEI_avg_2[10])
      avg_within_RMSE_prop = within_rmse_1.2_prop
      
      
    } else if (nsess == 3) {
      IEI_avg_3 = dat[dat$session == 3, "IEI_avg"]
      within_rmse_1.3 = sqrt(mean((IEI_avg_1 - IEI_avg_3)^2))
      within_rmse_2.3 = sqrt(mean((IEI_avg_2 - IEI_avg_3)^2))
      
      within_rmse_1.3_prop = sqrt(mean(((IEI_avg_1/IEI_avg_1[10]) - (IEI_avg_3/IEI_avg_3[10]))^2))
      within_rmse_2.3_prop = sqrt(mean(((IEI_avg_2/IEI_avg_2[10]) - (IEI_avg_3/IEI_avg_3[10]))^2))
      
      
      avg_within_RMSE = mean(within_rmse_1.2, within_rmse_1.3, within_rmse_2.3)
      avg_within_RMSE_prop = mean(within_rmse_1.2_prop, within_rmse_1.3_prop, within_rmse_2.3_prop)
      avg_within_RMSE_scaled = mean(within_rmse_1.2/abs(IEI_avg_1[10] - IEI_avg_2[10]), 
                                    within_rmse_1.3/abs(IEI_avg_1[10] - IEI_avg_3[10]), 
                                    within_rmse_2.3/abs(IEI_avg_2[10] - IEI_avg_3[10]))
      
      
    }
    RMSE_int10_meal_IEI[i,"within_RMSE"] = avg_within_RMSE
    RMSE_int10_meal_IEI[i,"within_RMSE_scaled"] = avg_within_RMSE_scaled
    RMSE_int10_meal_IEI[i,"within_RMSE_prop"] = avg_within_RMSE_prop
    
    dat_other = Meal_Event_in_percentage_interval_10[Meal_Event_in_percentage_interval_10$ParID != ID[i],]
    dat_other_wide = dcast(dat_other, IntNum ~ ParID + session, value.var = "IEI_avg")
    n_other = ncol(dat_other_wide)
    
    for (s in 1:nsess) {
      # By session average RMSE
      #btw_RMSE_vector = NA
      for (c in 2:n_other) {
        IEI_avg = dat[dat$session == s, "IEI_avg"]
        IEI_avg_other = dat_other_wide[,c]
        btw_RMSE = sqrt(mean((IEI_avg - IEI_avg_other)^2))
        btw_RMSE_scaled = btw_RMSE/abs(IEI_avg[10] - IEI_avg_other[10])
        btw_RMSE_prop = sqrt(mean(((IEI_avg/IEI_avg[10]) - (IEI_avg_other/IEI_avg_other[10]))^2))
        
        #add to vector
        btw_RMSE_vector[c-1] = btw_RMSE
        btw_RMSE_vector_scaled[c-1] = btw_RMSE_scaled
        btw_RMSE_vector_prop[c-1] = btw_RMSE_prop
      }
      #RMSE_int10[i,"between_RMSE_sess"] = mean(btw_RMSE_vector)
    }
    RMSE_int10_meal_IEI[i,"between_RMSE"] = mean(btw_RMSE_vector)
    RMSE_int10_meal_IEI[i,"between_RMSE_scaled"] = mean(btw_RMSE_vector_scaled)
    RMSE_int10_meal_IEI[i,"between_RMSE_prop"] = mean(btw_RMSE_vector_prop)
  }
  
}

n_meal_IEI <- length(RMSE_int10_meal_IEI$within_RMSE[!is.na(RMSE_int10_meal_IEI$within_RMSE)])
n_meal_IEI_less_error_within <- sum(RMSE_int10_meal_IEI$between_RMSE>RMSE_int10_meal_IEI$within_RMSE, na.rm = TRUE)


meal_mean_IEI_within <- mean(RMSE_int10_meal_IEI$within_RMSE, na.rm = TRUE)
meal_SD_IEI_within <- sd(RMSE_int10_meal_IEI$within_RMSE, na.rm = TRUE)
meal_mean_IEI_btw <- mean(RMSE_int10_meal_IEI$between_RMSE, na.rm = TRUE)
meal_SD_IEI_btw <- sd(RMSE_int10_meal_IEI$between_RMSE, na.rm = TRUE)

```


```{r IEI intervals between and within person RMSE - SNACKS, include=FALSE}
library(reshape2)

ID = unique(Snack_Event_in_percentage_interval_10$ParID)
RMSE_int10_snack_IEI = data.frame(matrix(rep(NA,8*length(ID)),ncol = 8))
names(RMSE_int10_snack_IEI) = c("ParID", "nsess","within_RMSE","between_RMSE","within_RMSE_scaled",
                      "between_RMSE_scaled","within_RMSE_prop","between_RMSE_prop")

for (i in 1:length(ID)) {
  dat = Snack_Event_in_percentage_interval_10[Snack_Event_in_percentage_interval_10$ParID == ID[i],]
  nsess = length(unique(dat$session))
  RMSE_int10_snack_IEI[i,"ParID"] = as.character(ID[i])
  RMSE_int10_snack_IEI[i,"nsess"] = nsess
  
  if (nsess > 1) {
    btw_RMSE_vector = NA
    btw_RMSE_vector_scaled = NA
    btw_RMSE_vector_prop = NA
    
    IEI_avg_1 = dat[dat$session == 1, "IEI_avg"]
    IEI_avg_2 = dat[dat$session == 2, "IEI_avg"]
    within_rmse_1.2 = sqrt(mean((IEI_avg_1 - IEI_avg_2)^2))
    within_rmse_1.2_prop = sqrt(mean(((IEI_avg_1/IEI_avg_1[10]) - (IEI_avg_2/IEI_avg_2[10]))^2))
    
    if (nsess == 2) {
      avg_within_RMSE = within_rmse_1.2
      avg_within_RMSE_scaled = within_rmse_1.2/abs(IEI_avg_1[10] - IEI_avg_2[10])
      avg_within_RMSE_prop = within_rmse_1.2_prop
      
      
    } else if (nsess == 3) {
      IEI_avg_3 = dat[dat$session == 3, "IEI_avg"]
      within_rmse_1.3 = sqrt(mean((IEI_avg_1 - IEI_avg_3)^2))
      within_rmse_2.3 = sqrt(mean((IEI_avg_2 - IEI_avg_3)^2))
      
      within_rmse_1.3_prop = sqrt(mean(((IEI_avg_1/IEI_avg_1[10]) - (IEI_avg_3/IEI_avg_3[10]))^2))
      within_rmse_2.3_prop = sqrt(mean(((IEI_avg_2/IEI_avg_2[10]) - (IEI_avg_3/IEI_avg_3[10]))^2))
      
      
      avg_within_RMSE = mean(within_rmse_1.2, within_rmse_1.3, within_rmse_2.3)
      avg_within_RMSE_prop = mean(within_rmse_1.2_prop, within_rmse_1.3_prop, within_rmse_2.3_prop)
      avg_within_RMSE_scaled = mean(within_rmse_1.2/abs(IEI_avg_1[10] - IEI_avg_2[10]), 
                                    within_rmse_1.3/abs(IEI_avg_1[10] - IEI_avg_3[10]), 
                                    within_rmse_2.3/abs(IEI_avg_2[10] - IEI_avg_3[10]))
      
      
    }
    RMSE_int10_snack_IEI[i,"within_RMSE"] = avg_within_RMSE
    RMSE_int10_snack_IEI[i,"within_RMSE_scaled"] = avg_within_RMSE_scaled
    RMSE_int10_snack_IEI[i,"within_RMSE_prop"] = avg_within_RMSE_prop
    
    dat_other = Snack_Event_in_percentage_interval_10[Snack_Event_in_percentage_interval_10$ParID != ID[i],]
    dat_other_wide = dcast(dat_other, IntNum ~ ParID + session, value.var = "IEI_avg")
    n_other = ncol(dat_other_wide)
    
    for (s in 1:nsess) {
      # By session average RMSE
      #btw_RMSE_vector = NA
      for (c in 2:n_other) {
        IEI_avg = dat[dat$session == s, "IEI_avg"]
        IEI_avg_other = dat_other_wide[,c]
        btw_RMSE = sqrt(mean((IEI_avg - IEI_avg_other)^2))
        btw_RMSE_scaled = btw_RMSE/abs(IEI_avg[10] - IEI_avg_other[10])
        btw_RMSE_prop = sqrt(mean(((IEI_avg/IEI_avg[10]) - (IEI_avg_other/IEI_avg_other[10]))^2))
        
        #add to vector
        btw_RMSE_vector[c-1] = btw_RMSE
        btw_RMSE_vector_scaled[c-1] = btw_RMSE_scaled
        btw_RMSE_vector_prop[c-1] = btw_RMSE_prop
      }
      #RMSE_int10[i,"between_RMSE_sess"] = mean(btw_RMSE_vector)
    }
    
    RMSE_int10_snack_IEI[i,"between_RMSE"] = mean(btw_RMSE_vector)
    RMSE_int10_snack_IEI[i,"between_RMSE_scaled"] = mean(btw_RMSE_vector_scaled)
    RMSE_int10_snack_IEI[i,"between_RMSE_prop"] = mean(btw_RMSE_vector_prop)
  }
  
}

n_snack_IEI <- length(RMSE_int10_snack_IEI$within_RMSE[!is.na(RMSE_int10_snack_IEI$within_RMSE)])
n_snack_IEI_less_error_within <- sum(RMSE_int10_snack_IEI$between_RMSE>RMSE_int10_snack_IEI$within_RMSE, na.rm = TRUE)


snack_mean_IEI_within <- mean(RMSE_int10_snack_IEI$within_RMSE, na.rm = TRUE)
snack_SD_IEI_within <- sd(RMSE_int10_snack_IEI$within_RMSE, na.rm = TRUE)
snack_mean_IEI_btw <- mean(RMSE_int10_snack_IEI$between_RMSE, na.rm = TRUE)
snack_SD_IEI_btw <- sd(RMSE_int10_snack_IEI$between_RMSE, na.rm = TRUE)

```

## Results section

###For cumulative bite patterns: 

'Across meals and snacks, `r n_meal_bite_less_error_within`/`r n_meal_bite` and `r n_snack_bite_less_error_within`/`r n_snack_bite` children, respectively, had more consistent cumulative bite patterns when compared to self than others'

'for meals, the average within-person error in number of bites was `r round(meal_mean_bite_within, digits = 1)` (`r round(meal_SD_bite_within, digits = 1)`) while the average between-person error was `r round(meal_mean_bite_btw, digits = 1)` (`r round(meal_SD_bite_btw, digits = 1)`).'

'for snacks, the average within-person error in number of bites was `r round(snack_mean_bite_within, digits = 1 )` (`r round(snack_SD_bite_within, digits = 2)`) while the average between-person error was `r round(snack_mean_bite_btw, digits = 1)` (`r round(snack_SD_bite_btw, digits = 1)`).'

###For IBI patterns: 

'Across meals and snacks, `r n_meal_IEI_less_error_within`/`r n_meal_IEI` and `r n_snack_IEI_less_error_within`/`r n_snack_IEI` children, respectively, had more consistent IBI patterns when compared to self than others'

'for meals, the average within-person error in time between bites was `r round(meal_mean_IEI_within, digits = 1)` (`r round(meal_SD_IEI_within, digits = 1)`) while the average between-person error was `r round(meal_mean_IEI_btw, digits = 1)` (`r round(meal_SD_IEI_btw, digits = 1)`).'

'for snacks, the average within-person error in time between bites was `r round(snack_mean_IEI_within, digits = 1)` (`r round(snack_SD_IEI_within, digits = 2)`) while the average between-person error was `r round(snack_mean_IEI_btw, digits = 1)` (`r round(snack_SD_IEI_btw, digits = 1)`).'
